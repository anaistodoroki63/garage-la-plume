<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Garage La Plume</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#1c1c1c;color:#fff}
header,footer{background:#111;padding:20px;border-bottom:4px solid #c30000}
footer{border-top:4px solid #c30000;text-align:center}
nav ul{list-style:none;display:flex;gap:20px;padding:0}
nav a{color:#fff;text-decoration:none;font-weight:bold}
nav a:hover{color:#c30000}
section{padding:40px;max-width:1100px;margin:auto}
.hero{text-align:center;padding:80px;background:linear-gradient(rgba(0,0,0,.7),rgba(0,0,0,.7)),
url("https://images.unsplash.com/photo-1581579185169-07c97f4c7b5d") center/cover}
.hero h2{color:#c30000;font-size:38px}
.box{background:#2a2a2a;padding:20px;border-left:4px solid #c30000;margin-bottom:20px}
input,textarea{width:100%;padding:10px;margin-bottom:10px;background:#111;color:#fff;border:1px solid #555}
button{background:#c30000;border:none;color:#fff;padding:10px;cursor:pointer}
button:hover{background:red}
.hidden{display:none}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.day{background:#111;padding:5px;border:1px solid #333;font-size:12px}
.event{background:#c30000;margin-top:3px;padding:2px;font-size:11px}
</style>
</head>

<body>

<header>
<h1>Garage La Plume</h1>
<nav>
<ul>
<li><a href="#accueil">Accueil</a></li>
<li><a href="#services">Services</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#employe">Employ√©</a></li>
</ul>
</nav>
</header>

<section class="hero" id="accueil">
<h2>Garage Automobile de Confiance</h2>
<p>R√©paration ‚Ä¢ Entretien ‚Ä¢ Diagnostic</p>
</section>

<section id="services">
<h2>Nos Services</h2>
<div class="box">üîß R√©paration m√©canique</div>
<div class="box">üõ¢ D√©pannage</div>
<div class="box">üíª Diagnostic √©lectronique</div>
<div class="box">üöó Pr√©-contr√¥le technique</div>
</section>

<section id="contact">
<h2>Contact</h2>
<div class="box">
<input placeholder="Nom">
<input placeholder="Email">
<textarea placeholder="Message"></textarea>
<button>Envoyer</button>
</div>
</section>

<section id="employe">
<h2>Espace Employ√© üîê</h2>

<div id="loginBox" class="box">
<input id="user" placeholder="Identifiant">
<input id="pass" type="password" placeholder="Mot de passe">
<button onclick="login()">Connexion</button>
<p id="msg" style="color:red"></p>
</div>

<div id="dashboard" class="hidden">

<p id="roleText"></p>

<div class="box">
<h3>üìÖ Planning</h3>
<input type="date" id="eventDate">
<input id="eventText" placeholder="Entretien / Mission">
<button onclick="ajouterPlanning()">Ajouter</button>
<div id="calendar" class="calendar"></div>
</div>

<div class="box">
<h3>‚è± Pointeuse</h3>
<button onclick="pointeuse('Entr√©e')">Entr√©e</button>
<button onclick="pointeuse('Sortie')">Sortie</button>
<ul id="clockList"></ul>
<p id="heuresTravaillees"></p>
</div>

<div class="box">
<h3>üìÅ Documents</h3>
<input type="file" id="fileInput">
<button onclick="uploadFile()">Uploader</button>
<ul id="fileList"></ul>
</div>

<div id="adminPanel" class="box hidden">
<h3>üëë Vue Patron</h3>
<div id="globalData"></div>
</div>

<button onclick="logout()">D√©connexion</button>
</div>
</section>

<footer>
<p>&copy; 2026 Garage La Plume</p>
</footer>

<script>
/* COMPTES */
if(!localStorage.users){
localStorage.users=JSON.stringify([
{user:"patron",pass:"patron123",role:"Patron"},
{user:"jean",pass:"jean123",role:"Employ√©"},
{user:"paul",pass:"paul123",role:"Employ√©"}
]);}

let currentUser=null;

/* LOGIN */
function login(){
const users=JSON.parse(localStorage.users);
const u=users.find(x=>x.user===user.value&&x.pass===pass.value);
if(!u){msg.textContent="Identifiants incorrects";return;}
currentUser=u;
roleText.textContent=u.user+" ("+u.role+")";
loginBox.classList.add("hidden");
dashboard.classList.remove("hidden");
adminPanel.classList.toggle("hidden",u.role!=="Patron");
chargerPlanning();chargerPointeuse();chargerHeures();chargerFichiers();
}

/* LOGOUT */
function logout(){
currentUser=null;
dashboard.classList.add("hidden");
loginBox.classList.remove("hidden");
}

/* PLANNING */
function ajouterPlanning(){
if(!eventDate.value||!eventText.value)return;
const d=JSON.parse(localStorage.planning||"{}");
const k=currentUser.user+"|"+eventDate.value;
if(!d[k])d[k]=[];
d[k].push(eventText.value);
localStorage.planning=JSON.stringify(d);
eventText.value="";
chargerPlanning();
}

function chargerPlanning(){
calendar.innerHTML="";
const n=new Date(),y=n.getFullYear(),m=String(n.getMonth()+1).padStart(2,"0");
const days=new Date(y,m,0).getDate();
const d=JSON.parse(localStorage.planning||"{}");
for(let i=1;i<=days;i++){
const day=String(i).padStart(2,"0");
const date=y+"-"+m+"-"+day;
const div=document.createElement("div");
div.className="day";
div.innerHTML="<strong>"+i+"</strong>";
(d[currentUser.user+"|"+date]||[]).forEach(e=>{
const ev=document.createElement("div");
ev.className="event";ev.textContent=e;div.appendChild(ev);
});
calendar.appendChild(div);
}
}

/* POINTEUSE */
function pointeuse(type){
const d=JSON.parse(localStorage.pointage||"{}");
if(!d[currentUser.user])d[currentUser.user]=[];
const logs=d[currentUser.user];
if(logs.length&&logs[logs.length-1].type===type)return alert("Action d√©j√† faite");
logs.push({type,time:new Date().toISOString()});
localStorage.pointage=JSON.stringify(d);
chargerPointeuse();chargerHeures();
}

function chargerPointeuse(){
clockList.innerHTML="";
(JSON.parse(localStorage.pointage||"{}")[currentUser.user]||[])
.forEach(l=>{
const li=document.createElement("li");
li.textContent=l.type+" - "+new Date(l.time).toLocaleString();
clockList.appendChild(li);
});
}

/* HEURES */
function chargerHeures(){
const logs=(JSON.parse(localStorage.pointage||"{}")[currentUser.user]||[]);
let t=0;
for(let i=0;i<logs.length;i+=2){
if(logs[i+1])t+=new Date(logs[i+1].time)-new Date(logs[i].time);
}
heuresTravaillees.textContent="Heures travaill√©es : "+(t/3600000).toFixed(2)+" h";
if(currentUser.role==="Patron")chargerHeuresGlobales();
}

function chargerHeuresGlobales(){
const d=JSON.parse(localStorage.pointage||"{}");
globalData.innerHTML="";
for(let u in d){
let t=0,l=d[u];
for(let i=0;i<l.length;i+=2){
if(l[i+1])t+=new Date(l[i+1].time)-new Date(l[i].time);
}
globalData.innerHTML+=`<p><strong>${u}</strong> : ${(t/3600000).toFixed(2)} h</p>`;
}
}

/* FICHIERS */
function uploadFile(){
if(!fileInput.files[0])return;
const d=JSON.parse(localStorage.files||"{}");
if(!d[currentUser.user])d[currentUser.user]=[];
d[currentUser.user].push(fileInput.files[0].name);
localStorage.files=JSON.stringify(d);
chargerFichiers();fileInput.value="";
}

function chargerFichiers(){
fileList.innerHTML="";
(JSON.parse(localStorage.files||"{}")[currentUser.user]||[])
.forEach(f=>{
const li=document.createElement("li");
li.textContent=f;fileList.appendChild(li);
});
}
</script>

</body>
</html>
