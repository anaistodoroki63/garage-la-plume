<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <title>Garage La Plume - Server Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&amp;family=Poppins:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
        * {
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1729 100%);
            color: #e0e0e0;
            overflow: hidden;
        }

        .app-wrapper {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ===== HEADER ===== */
        .header {
            background: rgba(15, 23, 41, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #00d4ff;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            box-shadow: 0 4px 30px rgba(0, 212, 255, 0.15);
        }

        .header-title {
            font-family: 'Space Mono', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: #00d4ff;
            margin: 0;
            letter-spacing: 1px;
        }

        .header-status {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00ff88;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px #00ff88;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
            gap: 0;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 250px;
            background: rgba(10, 14, 39, 0.8);
            border-right: 1px solid rgba(0, 212, 255, 0.2);
            overflow-y: auto;
            padding: 1.5rem 0;
            flex-shrink: 0;
        }

        .sidebar-item {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            color: #a0a0a0;
            font-weight: 500;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .sidebar-item:hover {
            background: rgba(0, 212, 255, 0.05);
            color: #00d4ff;
        }

        .sidebar-item.active {
            border-left-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
            color: #00d4ff;
            box-shadow: inset 0 0 15px rgba(0, 212, 255, 0.1);
        }

        .sidebar-item-icon {
            font-size: 1.3rem;
        }

        /* ===== CONTENT AREA ===== */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(10, 14, 39, 0.5) 0%, rgba(26, 31, 58, 0.5) 100%);
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            font-family: 'Space Mono', monospace;
            font-size: 1.8rem;
            color: #00d4ff;
            margin: 0 0 1.5rem 0;
            letter-spacing: 0.5px;
        }

        /* ===== CARDS ===== */
        .card {
            background: rgba(20, 30, 50, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(0, 212, 255, 0.4);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.15);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #00d4ff;
            margin: 0 0 1rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* ===== FORMS ===== */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 0.85rem;
            color: #a0a0a0;
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            background: rgba(15, 23, 41, 0.8);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 6px;
            padding: 0.75rem;
            color: #e0e0e0;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
            background: rgba(15, 23, 41, 0.95);
        }

        /* ===== BUTTONS ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff 0%, #00a8cc 100%);
            color: #0a0e27;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }

        .btn-secondary {
            background: rgba(0, 212, 255, 0.1);
            color: #00d4ff;
            border: 1px solid #00d4ff;
        }

        .btn-secondary:hover {
            background: rgba(0, 212, 255, 0.2);
        }

        .btn-danger {
            background: rgba(255, 51, 102, 0.1);
            color: #ff3366;
            border: 1px solid #ff3366;
        }

        .btn-danger:hover {
            background: rgba(255, 51, 102, 0.2);
        }

        /* ===== TABLES ===== */
        .table-wrapper {
            overflow-x: auto;
            margin: 1rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th {
            background: rgba(0, 212, 255, 0.1);
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            padding: 1rem;
            text-align: left;
            color: #00d4ff;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
            padding: 1rem;
            color: #e0e0e0;
        }

        tr:hover {
            background: rgba(0, 212, 255, 0.05);
        }

        /* ===== STATS ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-box {
            background: rgba(20, 30, 50, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            border-color: #00d4ff;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.15);
        }

        .stat-value {
            font-family: 'Space Mono', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            color: #00ff88;
            margin: 0.5rem 0;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #a0a0a0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ===== NOTIFICATIONS ===== */
        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid;
            animation: slideUp 0.3s ease;
            z-index: 1000;
            max-width: 400px;
        }

        .notification-success {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff88;
            color: #00ff88;
        }

        .notification-error {
            background: rgba(255, 51, 102, 0.1);
            border-color: #ff3366;
            color: #ff3366;
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 212, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 212, 255, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 212, 255, 0.5);
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-wrapper"><!-- HEADER -->
   <div class="header">
    <h1 class="header-title">‚öôÔ∏è SERVER MANAGER</h1>
    <div class="header-status"><span class="status-indicator"></span> <span>Syst√®me Op√©rationnel</span>
    </div>
   </div><!-- MAIN CONTENT -->
   <div class="main-content"><!-- SIDEBAR -->
    <div class="sidebar">
     <div class="sidebar-item active" data-section="dashboard"><span class="sidebar-item-icon">üìä</span> <span>Dashboard</span>
     </div>
     <div class="sidebar-item" data-section="users"><span class="sidebar-item-icon">üë•</span> <span>Utilisateurs</span>
     </div>
     <div class="sidebar-item" data-section="vehicles"><span class="sidebar-item-icon">üöó</span> <span>V√©hicules</span>
     </div>
     <div class="sidebar-item" data-section="reservations"><span class="sidebar-item-icon">üìÖ</span> <span>R√©servations</span>
     </div>
     <div class="sidebar-item" data-section="maintenance"><span class="sidebar-item-icon">üîß</span> <span>Maintenance</span>
     </div>
     <div class="sidebar-item" data-section="reports"><span class="sidebar-item-icon">üìà</span> <span>Rapports</span>
     </div>
     <div class="sidebar-item" data-section="settings"><span class="sidebar-item-icon">‚ö°</span> <span>Param√®tres</span>
     </div>
    </div><!-- CONTENT AREA -->
    <div class="content-area"><!-- DASHBOARD SECTION -->
     <div class="section active" data-section-content="dashboard">
      <h2 class="section-title">Dashboard G√©n√©ral</h2>
      <div class="stats-grid">
       <div class="stat-box">
        <div class="stat-label">
         Utilisateurs Actifs
        </div>
        <div class="stat-value" id="statUsers">
         0
        </div>
       </div>
       <div class="stat-box">
        <div class="stat-label">
         V√©hicules
        </div>
        <div class="stat-value" id="statVehicles">
         0
        </div>
       </div>
       <div class="stat-box">
        <div class="stat-label">
         R√©servations
        </div>
        <div class="stat-value" id="statReservations">
         0
        </div>
       </div>
       <div class="stat-box">
        <div class="stat-label">
         R√©visions Planifi√©es
        </div>
        <div class="stat-value" id="statMaintenance">
         0
        </div>
       </div>
      </div>
      <div class="card">
       <h3 class="card-title">üìã Activit√© R√©cente</h3>
       <div id="recentActivity" style="color: #a0a0a0; font-size: 0.9rem; line-height: 1.8;">
        ‚Ä¢ Syst√®me initialis√©<br>
         ‚Ä¢ En attente d'activit√©s...
       </div>
      </div>
     </div><!-- USERS SECTION -->
     <div class="section" data-section-content="users">
      <h2 class="section-title">Gestion des Utilisateurs</h2>
      <div class="card">
       <h3 class="card-title">‚ûï Ajouter un Utilisateur</h3>
       <div class="form-grid">
        <div class="form-group"><label>Nom Complet</label> <input type="text" id="userName" placeholder="Jean Dupont">
        </div>
        <div class="form-group"><label>Email</label> <input type="email" id="userEmail" placeholder="jean@garage.fr">
        </div>
        <div class="form-group"><label>T√©l√©phone</label> <input type="tel" id="userPhone" placeholder="06 12 34 56 78">
        </div>
        <div class="form-group"><label>R√¥le</label> <select id="userRole"> <option value="Client">Client</option> <option value="M√©canicien">M√©canicien</option> <option value="Manager">Manager</option> <option value="Admin">Admin</option> </select>
        </div>
       </div><button class="btn btn-primary" onclick="addUser()">Cr√©er Utilisateur</button>
      </div>
      <div class="card">
       <h3 class="card-title">üë• Liste des Utilisateurs</h3>
       <div class="table-wrapper">
        <table>
         <thead>
          <tr>
           <th>Nom</th>
           <th>Email</th>
           <th>R√¥le</th>
           <th>Actions</th>
          </tr>
         </thead>
         <tbody id="usersTable">
          <tr>
           <td colspan="4" style="text-align: center; color: #a0a0a0;">Aucun utilisateur</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div><!-- VEHICLES SECTION -->
     <div class="section" data-section-content="vehicles">
      <h2 class="section-title">Gestion des V√©hicules</h2>
      <div class="card">
       <h3 class="card-title">üöó Ajouter un V√©hicule</h3>
       <div class="form-grid">
        <div class="form-group"><label>Marque</label> <input type="text" id="vehicleBrand" placeholder="Peugeot">
        </div>
        <div class="form-group"><label>Mod√®le</label> <input type="text" id="vehicleModel" placeholder="308">
        </div>
        <div class="form-group"><label>Immatriculation</label> <input type="text" id="vehicleReg" placeholder="AB-123-CD">
        </div>
        <div class="form-group"><label>Ann√©e</label> <input type="number" id="vehicleYear" placeholder="2022">
        </div>
       </div><button class="btn btn-primary" onclick="addVehicle()">Ajouter V√©hicule</button>
      </div>
      <div class="card">
       <h3 class="card-title">üìã Parc Automobile</h3>
       <div class="table-wrapper">
        <table>
         <thead>
          <tr>
           <th>Marque</th>
           <th>Mod√®le</th>
           <th>Immatriculation</th>
           <th>Ann√©e</th>
           <th>Actions</th>
          </tr>
         </thead>
         <tbody id="vehiclesTable">
          <tr>
           <td colspan="5" style="text-align: center; color: #a0a0a0;">Aucun v√©hicule</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div><!-- RESERVATIONS SECTION -->
     <div class="section" data-section-content="reservations">
      <h2 class="section-title">Gestion des R√©servations</h2>
      <div class="card">
       <h3 class="card-title">üìÖ Nouvelle R√©servation</h3>
       <div class="form-grid">
        <div class="form-group"><label>Client</label> <select id="reservationClient"> <option value="">-- S√©lectionner --</option> </select>
        </div>
        <div class="form-group"><label>V√©hicule</label> <select id="reservationVehicle"> <option value="">-- S√©lectionner --</option> </select>
        </div>
        <div class="form-group"><label>Date</label> <input type="date" id="reservationDate">
        </div>
        <div class="form-group"><label>Description</label> <textarea id="reservationDesc" placeholder="D√©tails du service..."></textarea>
        </div>
       </div><button class="btn btn-primary" onclick="addReservation()">Cr√©er R√©servation</button>
      </div>
      <div class="card">
       <h3 class="card-title">üìã R√©servations</h3>
       <div class="table-wrapper">
        <table>
         <thead>
          <tr>
           <th>Client</th>
           <th>V√©hicule</th>
           <th>Date</th>
           <th>Statut</th>
           <th>Actions</th>
          </tr>
         </thead>
         <tbody id="reservationsTable">
          <tr>
           <td colspan="5" style="text-align: center; color: #a0a0a0;">Aucune r√©servation</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div><!-- MAINTENANCE SECTION -->
     <div class="section" data-section-content="maintenance">
      <h2 class="section-title">Planification Maintenance</h2>
      <div class="card">
       <h3 class="card-title">üîß Planifier une Maintenance</h3>
       <div class="form-grid">
        <div class="form-group"><label>V√©hicule</label> <select id="maintenanceVehicle"> <option value="">-- S√©lectionner --</option> </select>
        </div>
        <div class="form-group"><label>Type de Maintenance</label> <select id="maintenanceType"> <option value="R√©vision">R√©vision</option> <option value="Contr√¥le">Contr√¥le Technique</option> <option value="R√©paration">R√©paration</option> <option value="Entretien">Entretien</option> </select>
        </div>
        <div class="form-group"><label>Date Planifi√©e</label> <input type="date" id="maintenanceDate">
        </div>
        <div class="form-group"><label>Co√ªt Estim√©</label> <input type="number" id="maintenanceCost" placeholder="0.00">
        </div>
       </div><button class="btn btn-primary" onclick="addMaintenance()">Planifier</button>
      </div>
      <div class="card">
       <h3 class="card-title">üìã R√©visions Planifi√©es</h3>
       <div class="table-wrapper">
        <table>
         <thead>
          <tr>
           <th>V√©hicule</th>
           <th>Type</th>
           <th>Date</th>
           <th>Co√ªt</th>
           <th>Statut</th>
           <th>Actions</th>
          </tr>
         </thead>
         <tbody id="maintenanceTable">
          <tr>
           <td colspan="6" style="text-align: center; color: #a0a0a0;">Aucune maintenance planifi√©e</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div><!-- REPORTS SECTION -->
     <div class="section" data-section-content="reports">
      <h2 class="section-title">Rapports et Statistiques</h2>
      <div class="card">
       <h3 class="card-title">üìä Export de Donn√©es</h3>
       <div class="btn-group"><button class="btn btn-primary" onclick="exportData('users')">Exporter Utilisateurs</button> <button class="btn btn-primary" onclick="exportData('vehicles')">Exporter V√©hicules</button> <button class="btn btn-primary" onclick="exportData('reservations')">Exporter R√©servations</button> <button class="btn btn-primary" onclick="exportData('maintenance')">Exporter Maintenance</button>
       </div>
      </div>
      <div class="card">
       <h3 class="card-title">üìà Statistiques Globales</h3>
       <div id="statsContent" style="color: #a0a0a0; line-height: 2;">
        ‚Ä¢ Utilisateurs : <span id="totalUsers">0</span><br>
         ‚Ä¢ V√©hicules : <span id="totalVehicles">0</span><br>
         ‚Ä¢ R√©servations : <span id="totalReservations">0</span><br>
         ‚Ä¢ Maintenances : <span id="totalMaintenance">0</span>
       </div>
      </div>
     </div><!-- SETTINGS SECTION -->
     <div class="section" data-section-content="settings">
      <h2 class="section-title">Param√®tres Syst√®me</h2>
      <div class="card">
       <h3 class="card-title">üíæ Base de Donn√©es</h3>
       <div class="btn-group"><button class="btn btn-secondary" onclick="backupData()">üíæ Sauvegarder</button> <button class="btn btn-secondary" onclick="restoreData()">üì• Restaurer</button> <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Effacer Tout</button>
       </div>
      </div>
      <div class="card">
       <h3 class="card-title">‚ö° Maintenance Syst√®me</h3>
       <div class="btn-group"><button class="btn btn-secondary" onclick="optimizeDB()">üîß Optimiser</button> <button class="btn btn-secondary" onclick="cleanLogs()">üßπ Nettoyer Logs</button> <button class="btn btn-secondary" onclick="systemStatus()">üîç √âtat Syst√®me</button>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Data Management
        const db = {
            users: JSON.parse(localStorage.getItem('garageUsers') || '[]'),
            vehicles: JSON.parse(localStorage.getItem('garageVehicles') || '[]'),
            reservations: JSON.parse(localStorage.getItem('garageReservations') || '[]'),
            maintenance: JSON.parse(localStorage.getItem('garageMaintenance') || '[]')
        };

        function saveDB() {
            localStorage.setItem('garageUsers', JSON.stringify(db.users));
            localStorage.setItem('garageVehicles', JSON.stringify(db.vehicles));
            localStorage.setItem('garageReservations', JSON.stringify(db.reservations));
            localStorage.setItem('garageMaintenance', JSON.stringify(db.maintenance));
        }

        // Navigation
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                
                item.classList.add('active');
                const section = item.getAttribute('data-section');
                document.querySelector(`[data-section-content="${section}"]`).classList.add('active');

                if (section === 'users') updateUserSelects();
                if (section === 'vehicles') updateVehicleSelects();
            });
        });

        // Notifications
        function showNotification(msg, type = 'success') {
            const div = document.createElement('div');
            div.className = `notification notification-${type}`;
            div.textContent = msg;
            document.body.appendChild(div);
            setTimeout(() => {
                div.style.animation = 'fadeOut 0.3s ease forwards';
                setTimeout(() => div.remove(), 300);
            }, 3000);
        }

        // Users Management
        function addUser() {
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            const phone = document.getElementById('userPhone').value.trim();
            const role = document.getElementById('userRole').value;

            if (!name || !email) {
                showNotification('Veuillez remplir tous les champs requis', 'error');
                return;
            }

            db.users.push({ id: Date.now(), name, email, phone, role });
            saveDB();
            updateUsersTable();
            updateUserSelects();
            
            document.getElementById('userName').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userPhone').value = '';
            
            showNotification(`Utilisateur ${name} cr√©√©`);
            updateStats();
        }

        function deleteUser(id) {
            if (!confirm('Confirmer la suppression ?')) return;
            db.users = db.users.filter(u => u.id !== id);
            saveDB();
            updateUsersTable();
            updateUserSelects();
            showNotification('Utilisateur supprim√©');
            updateStats();
        }

        function updateUsersTable() {
            const tbody = document.getElementById('usersTable');
            if (db.users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #a0a0a0;">Aucun utilisateur</td></tr>';
                return;
            }
            tbody.innerHTML = db.users.map(u => `
                <tr>
                    <td>${u.name}</td>
                    <td>${u.email}</td>
                    <td>${u.role}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteUser(${u.id})" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Supprimer</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateUserSelects() {
            const clients = db.users.filter(u => u.role === 'Client');
            const selects = [
                document.getElementById('reservationClient'),
                document.getElementById('reservationClient')
            ];
            selects.forEach(select => {
                if (!select) return;
                const current = select.value;
                select.innerHTML = '<option value="">-- S√©lectionner --</option>' + 
                    clients.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
                select.value = current;
            });
        }

        // Vehicles Management
        function addVehicle() {
            const brand = document.getElementById('vehicleBrand').value.trim();
            const model = document.getElementById('vehicleModel').value.trim();
            const reg = document.getElementById('vehicleReg').value.trim();
            const year = document.getElementById('vehicleYear').value;

            if (!brand || !model || !reg) {
                showNotification('Veuillez remplir tous les champs requis', 'error');
                return;
            }

            db.vehicles.push({ id: Date.now(), brand, model, reg, year });
            saveDB();
            updateVehiclesTable();
            updateVehicleSelects();
            
            document.getElementById('vehicleBrand').value = '';
            document.getElementById('vehicleModel').value = '';
            document.getElementById('vehicleReg').value = '';
            document.getElementById('vehicleYear').value = '';
            
            showNotification(`V√©hicule ${brand} ${model} ajout√©`);
            updateStats();
        }

        function deleteVehicle(id) {
            if (!confirm('Confirmer la suppression ?')) return;
            db.vehicles = db.vehicles.filter(v => v.id !== id);
            saveDB();
            updateVehiclesTable();
            updateVehicleSelects();
            showNotification('V√©hicule supprim√©');
            updateStats();
        }

        function updateVehiclesTable() {
            const tbody = document.getElementById('vehiclesTable');
            if (db.vehicles.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #a0a0a0;">Aucun v√©hicule</td></tr>';
                return;
            }
            tbody.innerHTML = db.vehicles.map(v => `
                <tr>
                    <td>${v.brand}</td>
                    <td>${v.model}</td>
                    <td>${v.reg}</td>
                    <td>${v.year}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteVehicle(${v.id})" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Supprimer</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateVehicleSelects() {
            const selects = [
                document.getElementById('reservationVehicle'),
                document.getElementById('maintenanceVehicle')
            ];
            selects.forEach(select => {
                if (!select) return;
                const current = select.value;
                select.innerHTML = '<option value="">-- S√©lectionner --</option>' + 
                    db.vehicles.map(v => `<option value="${v.id}">${v.brand} ${v.model} (${v.reg})</option>`).join('');
                select.value = current;
            });
        }

        // Reservations Management
        function addReservation() {
            const clientId = document.getElementById('reservationClient').value;
            const vehicleId = document.getElementById('reservationVehicle').value;
            const date = document.getElementById('reservationDate').value;
            const desc = document.getElementById('reservationDesc').value.trim();

            if (!clientId || !vehicleId || !date) {
                showNotification('Veuillez remplir tous les champs requis', 'error');
                return;
            }

            const client = db.users.find(u => u.id == clientId);
            const vehicle = db.vehicles.find(v => v.id == vehicleId);

            db.reservations.push({
                id: Date.now(),
                clientName: client.name,
                vehicleInfo: `${vehicle.brand} ${vehicle.model}`,
                date,
                desc,
                status: 'Planifi√©e'
            });
            saveDB();
            updateReservationsTable();
            
            document.getElementById('reservationClient').value = '';
            document.getElementById('reservationVehicle').value = '';
            document.getElementById('reservationDate').value = '';
            document.getElementById('reservationDesc').value = '';
            
            showNotification('R√©servation cr√©√©e');
            updateStats();
        }

        function deleteReservation(id) {
            if (!confirm('Confirmer la suppression ?')) return;
            db.reservations = db.reservations.filter(r => r.id !== id);
            saveDB();
            updateReservationsTable();
            showNotification('R√©servation supprim√©e');
            updateStats();
        }

        function updateReservationsTable() {
            const tbody = document.getElementById('reservationsTable');
            if (db.reservations.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #a0a0a0;">Aucune r√©servation</td></tr>';
                return;
            }
            tbody.innerHTML = db.reservations.map(r => `
                <tr>
                    <td>${r.clientName}</td>
                    <td>${r.vehicleInfo}</td>
                    <td>${r.date}</td>
                    <td>${r.status}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteReservation(${r.id})" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Supprimer</button>
                    </td>
                </tr>
            `).join('');
        }

        // Maintenance Management
        function addMaintenance() {
            const vehicleId = document.getElementById('maintenanceVehicle').value;
            const type = document.getElementById('maintenanceType').value;
            const date = document.getElementById('maintenanceDate').value;
            const cost = document.getElementById('maintenanceCost').value;

            if (!vehicleId || !date) {
                showNotification('Veuillez remplir tous les champs requis', 'error');
                return;
            }

            const vehicle = db.vehicles.find(v => v.id == vehicleId);

            db.maintenance.push({
                id: Date.now(),
                vehicleInfo: `${vehicle.brand} ${vehicle.model}`,
                type,
                date,
                cost,
                status: 'Planifi√©e'
            });
            saveDB();
            updateMaintenanceTable();
            
            document.getElementById('maintenanceVehicle').value = '';
            document.getElementById('maintenanceDate').value = '';
            document.getElementById('maintenanceCost').value = '';
            
            showNotification('Maintenance planifi√©e');
            updateStats();
        }

        function deleteMaintenance(id) {
            if (!confirm('Confirmer la suppression ?')) return;
            db.maintenance = db.maintenance.filter(m => m.id !== id);
            saveDB();
            updateMaintenanceTable();
            showNotification('Maintenance supprim√©e');
            updateStats();
        }

        function updateMaintenanceTable() {
            const tbody = document.getElementById('maintenanceTable');
            if (db.maintenance.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #a0a0a0;">Aucune maintenance planifi√©e</td></tr>';
                return;
            }
            tbody.innerHTML = db.maintenance.map(m => `
                <tr>
                    <td>${m.vehicleInfo}</td>
                    <td>${m.type}</td>
                    <td>${m.date}</td>
                    <td>${m.cost ? m.cost + '‚Ç¨' : '-'}</td>
                    <td>${m.status}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteMaintenance(${m.id})" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Supprimer</button>
                    </td>
                </tr>
            `).join('');
        }

        // Stats
        function updateStats() {
            document.getElementById('statUsers').textContent = db.users.length;
            document.getElementById('statVehicles').textContent = db.vehicles.length;
            document.getElementById('statReservations').textContent = db.reservations.length;
            document.getElementById('statMaintenance').textContent = db.maintenance.length;

            document.getElementById('totalUsers').textContent = db.users.length;
            document.getElementById('totalVehicles').textContent = db.vehicles.length;
            document.getElementById('totalReservations').textContent = db.reservations.length;
            document.getElementById('totalMaintenance').textContent = db.maintenance.length;
        }

        // Export/Backup
        function exportData(type) {
            const data = type === 'users' ? db.users : 
                        type === 'vehicles' ? db.vehicles :
                        type === 'reservations' ? db.reservations : db.maintenance;
            
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `garage_${type}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showNotification(`Export ${type} r√©ussi`);
        }

        function backupData() {
            const allData = JSON.stringify(db, null, 2);
            const blob = new Blob([allData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `garage_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showNotification('Sauvegarde compl√®te r√©ussie');
        }

        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const restored = JSON.parse(event.target.result);
                        if (restored.users) db.users = restored.users;
                        if (restored.vehicles) db.vehicles = restored.vehicles;
                        if (restored.reservations) db.reservations = restored.reservations;
                        if (restored.maintenance) db.maintenance = restored.maintenance;
                        saveDB();
                        updateStats();
                        updateUsersTable();
                        updateVehiclesTable();
                        updateReservationsTable();
                        updateMaintenanceTable();
                        showNotification('Restauration r√©ussie');
                    } catch (e) {
                        showNotification('Erreur lors de la restauration', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function clearAllData() {
            if (!confirm('‚ö†Ô∏è Cette action effacera TOUTES les donn√©es ! √ätes-vous s√ªr ?')) return;
            if (!confirm('‚ö†Ô∏è DERNIERE CHANCE ! Confirmez pour effacer d√©finitivement.')) return;
            
            db.users = [];
            db.vehicles = [];
            db.reservations = [];
            db.maintenance = [];
            saveDB();
            updateStats();
            updateUsersTable();
            updateVehiclesTable();
            updateReservationsTable();
            updateMaintenanceTable();
            showNotification('Toutes les donn√©es ont √©t√© effac√©es');
        }

        function optimizeDB() {
            showNotification('Optimisation en cours...');
            setTimeout(() => showNotification('Base de donn√©es optimis√©e'), 500);
        }

        function cleanLogs() {
            showNotification('Logs nettoy√©s');
        }

        function systemStatus() {
            const status = `
                ‚úì Syst√®me op√©rationnel
                ‚Ä¢ Utilisateurs: ${db.users.length}
                ‚Ä¢ V√©hicules: ${db.vehicles.length}
                ‚Ä¢ R√©servations: ${db.reservations.length}
                ‚Ä¢ Maintenances: ${db.maintenance.length}
            `;
            alert(status);
        }

        // Initialize
        updateStats();
        updateUsersTable();
        updateVehiclesTable();
        updateReservationsTable();
        updateMaintenanceTable();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9caef254e36d2a04',t:'MTc3MDU5Mzc1OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
